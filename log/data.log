load_model finish
cfg Config (path: ./configs/lyh/trainval_config_i.py): {'dataset_type': 'KittiDataset', 'data_root': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/', 'class_names': ['Pedestrian', 'Cyclist', 'Car'], 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1], 'voxel_size': [0.16, 0.16, 4], 'length': 576, 'height': 496, 'output_shape': [496, 576], 'z_center_pedestrian': -0.6, 'z_center_cyclist': -0.6, 'z_center_car': -1.78, 'work_dir': '/workspace/mnt/storage/guangcongzheng/DAIR-V2X-C/train_model/vic3d_latefusion_inf_pointpillars', 'model': {'type': 'VoxelNet', 'voxel_layer': {'max_num_points': 32, 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1], 'voxel_size': [0.16, 0.16, 4], 'max_voxels': (16000, 40000)}, 'voxel_encoder': {'type': 'PillarFeatureNet', 'in_channels': 4, 'feat_channels': [64], 'with_distance': False, 'voxel_size': [0.16, 0.16, 4], 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, 'middle_encoder': {'type': 'PointPillarsScatter', 'in_channels': 64, 'output_shape': [496, 576]}, 'backbone': {'type': 'SECOND', 'in_channels': 64, 'layer_nums': [3, 5, 5], 'layer_strides': [2, 2, 2], 'out_channels': [64, 128, 256]}, 'neck': {'type': 'SECONDFPN', 'in_channels': [64, 128, 256], 'upsample_strides': [1, 2, 4], 'out_channels': [128, 128, 128]}, 'bbox_head': {'type': 'Anchor3DHead', 'num_classes': 3, 'in_channels': 384, 'feat_channels': 384, 'use_direction_classifier': True, 'anchor_generator': {'type': 'Anchor3DRangeGenerator', 'ranges': [[0, -39.68, -0.6, 92.16, 39.68, -0.6], [0, -39.68, -0.6, 92.16, 39.68, -0.6], [0, -39.68, -1.78, 92.16, 39.68, -1.78]], 'sizes': [[0.6, 0.8, 1.73], [0.6, 1.76, 1.73], [1.6, 3.9, 1.56]], 'rotations': [0, 1.57], 'reshape_out': False}, 'diff_rad_by_sin': True, 'bbox_coder': {'type': 'DeltaXYZWLHRBBoxCoder'}, 'loss_cls': {'type': 'FocalLoss', 'use_sigmoid': True, 'gamma': 2.0, 'alpha': 0.25, 'loss_weight': 1.0}, 'loss_bbox': {'type': 'SmoothL1Loss', 'beta': 0.1111111111111111, 'loss_weight': 2.0}, 'loss_dir': {'type': 'CrossEntropyLoss', 'use_sigmoid': False, 'loss_weight': 0.2}}, 'train_cfg': {'assigner': [{'type': 'MaxIoUAssigner', 'iou_calculator': {'type': 'BboxOverlapsNearest3D'}, 'pos_iou_thr': 0.5, 'neg_iou_thr': 0.35, 'min_pos_iou': 0.35, 'ignore_iof_thr': -1}, {'type': 'MaxIoUAssigner', 'iou_calculator': {'type': 'BboxOverlapsNearest3D'}, 'pos_iou_thr': 0.5, 'neg_iou_thr': 0.35, 'min_pos_iou': 0.35, 'ignore_iof_thr': -1}, {'type': 'MaxIoUAssigner', 'iou_calculator': {'type': 'BboxOverlapsNearest3D'}, 'pos_iou_thr': 0.6, 'neg_iou_thr': 0.45, 'min_pos_iou': 0.45, 'ignore_iof_thr': -1}], 'allowed_border': 0, 'pos_weight': -1, 'debug': False}, 'test_cfg': {'use_rotate_nms': True, 'nms_across_levels': False, 'nms_thr': 0.01, 'score_thr': 0.1, 'min_bbox_size': 0, 'nms_pre': 100, 'max_num': 50}}, 'file_client_args': {'backend': 'disk'}, 'train_pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True}, {'type': 'ObjectSample', 'db_sampler': {'data_root': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/', 'info_path': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side//kitti_dbinfos_train.pkl', 'rate': 1.0, 'prepare': {'filter_by_difficulty': [-1], 'filter_by_min_points': {'Car': 5, 'Pedestrian': 10, 'Cyclist': 10}}, 'classes': ['Pedestrian', 'Cyclist', 'Car'], 'sample_groups': {'Car': 15, 'Pedestrian': 10, 'Cyclist': 10}}}, {'type': 'ObjectNoise', 'num_try': 100, 'translation_std': [0.25, 0.25, 0.25], 'global_rot_range': [0.0, 0.0], 'rot_range': [-0.15707963267, 0.15707963267]}, {'type': 'RandomFlip3D', 'flip_ratio_bev_horizontal': 0.5}, {'type': 'GlobalRotScaleTrans', 'rot_range': [-0.78539816, 0.78539816], 'scale_ratio_range': [0.95, 1.05]}, {'type': 'PointsRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'ObjectRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'PointShuffle'}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car']}, {'type': 'Collect3D', 'keys': ['points', 'gt_bboxes_3d', 'gt_labels_3d']}], 'test_pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4}, {'type': 'MultiScaleFlipAug3D', 'img_scale': (496, 576), 'pts_scale_ratio': 1, 'flip': False, 'transforms': [{'type': 'GlobalRotScaleTrans', 'rot_range': [0, 0], 'scale_ratio_range': [1.0, 1.0], 'translation_std': [0, 0, 0]}, {'type': 'RandomFlip3D'}, {'type': 'PointsRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car'], 'with_label': False}, {'type': 'Collect3D', 'keys': ['points']}]}], 'eval_pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4, 'file_client_args': {'backend': 'disk'}}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car'], 'with_label': False}, {'type': 'Collect3D', 'keys': ['points']}], 'data': {'samples_per_gpu': 6, 'workers_per_gpu': 4, 'train': {'type': 'RepeatDataset', 'times': 2, 'dataset': {'type': 'KittiDataset', 'data_root': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/', 'ann_file': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side//kitti_infos_train.pkl', 'split': 'training', 'pts_prefix': 'velodyne_reduced', 'pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4}, {'type': 'LoadAnnotations3D', 'with_bbox_3d': True, 'with_label_3d': True}, {'type': 'ObjectSample', 'db_sampler': {'data_root': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/', 'info_path': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side//kitti_dbinfos_train.pkl', 'rate': 1.0, 'prepare': {'filter_by_difficulty': [-1], 'filter_by_min_points': {'Car': 5, 'Pedestrian': 10, 'Cyclist': 10}}, 'classes': ['Pedestrian', 'Cyclist', 'Car'], 'sample_groups': {'Car': 15, 'Pedestrian': 10, 'Cyclist': 10}}}, {'type': 'ObjectNoise', 'num_try': 100, 'translation_std': [0.25, 0.25, 0.25], 'global_rot_range': [0.0, 0.0], 'rot_range': [-0.15707963267, 0.15707963267]}, {'type': 'RandomFlip3D', 'flip_ratio_bev_horizontal': 0.5}, {'type': 'GlobalRotScaleTrans', 'rot_range': [-0.78539816, 0.78539816], 'scale_ratio_range': [0.95, 1.05]}, {'type': 'PointsRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'ObjectRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'PointShuffle'}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car']}, {'type': 'Collect3D', 'keys': ['points', 'gt_bboxes_3d', 'gt_labels_3d']}], 'modality': {'use_lidar': True, 'use_camera': False}, 'classes': ['Pedestrian', 'Cyclist', 'Car'], 'test_mode': False, 'pcd_limit_range': [0, -39.68, -3, 92.16, 39.68, 1], 'box_type_3d': 'LiDAR'}}, 'val': {'type': 'KittiDataset', 'data_root': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/', 'ann_file': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side//kitti_infos_val.pkl', 'split': 'training', 'pts_prefix': 'velodyne_reduced', 'pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4}, {'type': 'MultiScaleFlipAug3D', 'img_scale': (496, 576), 'pts_scale_ratio': 1, 'flip': False, 'transforms': [{'type': 'GlobalRotScaleTrans', 'rot_range': [0, 0], 'scale_ratio_range': [1.0, 1.0], 'translation_std': [0, 0, 0]}, {'type': 'RandomFlip3D'}, {'type': 'PointsRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car'], 'with_label': False}, {'type': 'Collect3D', 'keys': ['points']}]}], 'modality': {'use_lidar': True, 'use_camera': False}, 'classes': ['Pedestrian', 'Cyclist', 'Car'], 'test_mode': True, 'pcd_limit_range': [0, -39.68, -3, 92.16, 39.68, 1], 'box_type_3d': 'LiDAR'}, 'test': {'type': 'KittiDataset', 'data_root': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/', 'ann_file': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side//kitti_infos_val.pkl', 'split': 'training', 'pts_prefix': 'velodyne_reduced', 'pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4}, {'type': 'MultiScaleFlipAug3D', 'img_scale': (496, 576), 'pts_scale_ratio': 1, 'flip': False, 'transforms': [{'type': 'GlobalRotScaleTrans', 'rot_range': [0, 0], 'scale_ratio_range': [1.0, 1.0], 'translation_std': [0, 0, 0]}, {'type': 'RandomFlip3D'}, {'type': 'PointsRangeFilter', 'point_cloud_range': [0, -39.68, -3, 92.16, 39.68, 1]}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car'], 'with_label': False}, {'type': 'Collect3D', 'keys': ['points']}]}], 'modality': {'use_lidar': True, 'use_camera': False}, 'classes': ['Pedestrian', 'Cyclist', 'Car'], 'test_mode': True, 'pcd_limit_range': [0, -39.68, -3, 92.16, 39.68, 1], 'box_type_3d': 'LiDAR'}}, 'evaluation': {'interval': 2, 'pipeline': [{'type': 'LoadPointsFromFile', 'coord_type': 'LIDAR', 'load_dim': 4, 'use_dim': 4, 'file_client_args': {'backend': 'disk'}}, {'type': 'DefaultFormatBundle3D', 'class_names': ['Pedestrian', 'Cyclist', 'Car'], 'with_label': False}, {'type': 'Collect3D', 'keys': ['points']}]}, 'lr': 0.001, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'betas': (0.95, 0.99), 'weight_decay': 0.01}, 'optimizer_config': {'grad_clip': {'max_norm': 35, 'norm_type': 2}}, 'lr_config': {'policy': 'cyclic', 'target_ratio': (10, 0.0001), 'cyclic_times': 1, 'step_ratio_up': 0.4}, 'momentum_config': {'policy': 'cyclic', 'target_ratio': (0.8947368421052632, 1), 'cyclic_times': 1, 'step_ratio_up': 0.4}, 'runner': {'type': 'EpochBasedRunner', 'max_epochs': 20}, 'checkpoint_config': {'interval': 10}, 'log_config': {'interval': 50, 'hooks': [{'type': 'TextLoggerHook'}, {'type': 'TensorboardLoggerHook'}]}, 'dist_params': {'backend': 'nccl'}, 'log_level': 'INFO', 'load_from': None, 'resume_from': None, 'workflow': [('train', 1)], 'gpu_ids': range(0, 1)}
len data 17600
{'img_metas': DataContainer({'lidar2img': array([[ 8.05725708e+02, -2.22531006e+03, -2.63071594e+02,
        -1.16049238e+04],
       [ 3.87813721e+01,  6.98974762e+01, -1.95591870e+03,
         1.46575625e+04],
       [ 9.75751162e-01, -6.03149235e-02, -1.71585426e-01,
         1.06364238e+00],
       [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         1.00000000e+00]], dtype=float32), 'flip': True, 'pcd_horizontal_flip': True, 'pcd_vertical_flip': False, 'box_mode_3d': <Box3DMode.LIDAR: 0>, 'box_type_3d': <class 'mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes'>, 'pcd_trans': array([0., 0., 0.]), 'sample_idx': 9, 'pcd_scale_factor': 0.9780339897213421, 'pcd_rotation': tensor([[ 0.8443, -0.5358,  0.0000],
        [ 0.5358,  0.8443,  0.0000],
        [ 0.0000,  0.0000,  1.0000]]), 'pts_filename': './data/DAIR-V2X/cooperative-vehicle-infrastructure/infrastructure-side/training/velodyne_reduced/000009.bin', 'transformation_3d_flow': ['HF', 'R', 'S', 'T']}), 'points': DataContainer(tensor([[ 2.5872e+01, -2.3604e+01, -1.6573e+00,  5.3825e-04],
        [ 3.1371e+01, -6.5575e+00, -1.6609e+00,  9.0734e-04],
        [ 3.7063e+01, -2.6428e+01, -1.6821e+00,  2.6144e-04],
        ...,
        [ 1.6456e+01, -7.6061e+00, -5.2448e-01,  2.2914e-03],
        [ 2.6801e+01,  3.0420e+00, -1.7346e+00,  1.3841e-04],
        [ 3.6792e+01, -2.8458e+01, -1.6635e+00,  2.7682e-04]])), 'gt_bboxes_3d': DataContainer(LiDARInstance3DBoxes(
    tensor([[ 20.1516,  -5.3394,  -1.4267,   4.1411,   1.7652,   1.6518,  -2.4784],
        [ 41.4155, -18.1305,  -1.8499,   4.4707,   1.8966,   1.9405,  -2.5039],
        [ 59.9217, -14.8698,  -1.5892,   0.2178,   0.2142,   0.4397,  -1.5463],
        [ 61.1720, -17.9477,  -2.0197,   0.2527,   0.1821,   0.3851,  -2.1735],
        [ 54.4917, -28.6100,  -1.4305,   4.1228,   1.8334,   1.4708,  -2.5036],
        [ 59.6031, -11.0836,  -1.6932,   0.2723,   0.2103,   0.3574,  -1.4328],
        [ 64.1934, -20.8896,  -2.0431,   0.2017,   0.2045,   0.4388,  -2.2938],
        [ 18.3762,  -8.4189,  -1.7002,   4.4595,   1.8364,   1.9962,  -2.5286],
        [ 73.3772, -39.5447,  -2.0598,   4.4966,   1.9341,   1.5197,  -2.5354],
        [ 17.0872, -10.6875,  -1.4104,   4.2637,   1.9275,   1.4148,  -2.5525],
        [ 21.7284,  -3.2243,  -1.5022,   4.4486,   1.8344,   1.9940,  -2.7741],
        [ 13.6752, -13.5492,  -1.9977,   4.3937,   1.8974,   1.9605,  -2.5458],
        [ 71.5749, -23.4276,  -1.6922,   0.5885,   0.7046,   1.6953,  -1.3411],
        [ 19.5973, -22.7419,  -1.4891,   0.2663,   0.4147,   1.7129,  -0.8418],
        [ 49.5332, -10.3595,  -1.8029,   1.7685,   0.8613,   1.5297,  -2.5144],
        [ 39.1131,  -8.2970,  -2.2471,   1.6307,   0.6661,   1.7122,  -2.7499],
        [ 69.1593, -23.6012,  -2.1944,   1.6603,   0.8032,   1.8201,  -1.0055],
        [ 35.4527,  -8.0936,  -1.3669,   1.6633,   0.6649,   1.6987,  -2.6756],
        [ 71.1032, -36.5652,  -1.9252,   1.0023,   0.5095,   1.5657,  -0.9023],
        [ 49.6042, -18.0598,  -1.3461,   1.7098,   0.5756,   1.6017,  -2.4692],
        [ 74.6862, -17.9261,  -1.9024,   1.6121,   0.5975,   1.7040,  -1.1186]]))), 'gt_labels_3d': DataContainer(tensor([ 2, -1, -1, -1,  2, -1, -1, -1,  2,  2,  2,  2,  0,  0,  1,  1,  1,  1,
         1,  1,  1]))}
